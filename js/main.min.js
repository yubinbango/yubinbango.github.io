"use strict";function onGoogleSignInFailure(e){console.log(e)}function renderButton(){gapi.signin2.render("g-signin2",{scope:"profile",width:120,height:36,longtitle:!1,theme:"dark",onsuccess:onGoogleSignIn,onfailure:onGoogleSignInFailure})}function onGoogleSignIn(e){var t=e.getBasicProfile();if(console.log("ID: "+t.getId()),console.log("Name: "+t.getName()),console.log("Image URL: "+t.getImageUrl()),console.log("Email: "+t.getEmail()),!localStorage.getItem("registeredFireBase")){var o=new Firebase("https://family1st.firebaseio.com");o.authWithOAuthToken("google",e.getAuthResponse().access_token,function(e,t){e?console.log("Login Failed!",e):(console.log("Authenticated successfully with payload:",t),o.child("users").child(t.uid).set({provider:t.provider,name:getName(t),email:getEmail(t),member:"guest",timestamp:Firebase.ServerValue.TIMESTAMP}),localStorage.setItem("registeredFireBase","true"))})}[[".rpEmail",t.getEmail()],[".rpName",t.getName()]].forEach(function(e){applyDOM(e[0],e[1])}),removeClass(".isLogin","hide"),addClass(".isNotLogin","hide"),[["#name",t.getName()],["#email",t.getEmail()]].forEach(function(e){var t=document.querySelector(e[0]);null!==t&&(t.value=e[1])})}function getName(e){switch(e.provider){case"password":return e.password.email.replace(/@.*/,"");case"twitter":return e.twitter.displayName;case"facebook":return e.facebook.displayName;case"google":return e.google.displayName}}function getEmail(e){switch(e.provider){case"password":return e.password.email;case"twitter":return e.twitter.email;case"facebook":return e.facebook.email;case"google":return e.google.email}}function applyDOM(e,t){if(document.querySelector(e)){var o=document.querySelectorAll(e);Array.prototype.map.call(o,function(e){e.innerHTML=t})}}function addClass(e,t){if(document.querySelector(e)){var o=document.querySelectorAll(e);Array.prototype.map.call(o,function(e){e.classList.add(t)})}}function removeClass(e,t){if(document.querySelector(e)){var o=document.querySelectorAll(e);Array.prototype.map.call(o,function(e){e.classList.remove(t)})}}function getUrlVars(){for(var e={},t=location.search.substring(1).split("&"),o=0;o<t.length;o++){var a=t[o].search(/=/),n="";-1!=a&&(n=t[o].slice(0,a));var r=t[o].slice(t[o].indexOf("=",0)+1);""!=n&&(e[n]=decodeURI(r))}return e}function sendValGuerstRegist(e){axios.post("https://family1st-regist.appspot.com/regist/guest",{email:e.email.value}).then(function(e){console.log(e),addClass("#contactform","hide"),removeClass("#contactformsuccessalert","hide"),localStorage.setItem("registeredGuestMember","true")}).catch(function(e){console.log(e)})}function sendValContactForm(e){var t={};e.map(function(e){t[e.key]=e.elm.value}),axios.post("https://family1st-contact.appspot.com/send",t).then(function(e){console.log(e),addClass("#contactform","hide"),removeClass("#contactformsuccessalert","hide"),document.querySelector(".mdl-js-snackbar").MaterialSnackbar.showSnackbar({message:"送信が完了しました"})}).catch(function(e){console.log(e)})}document.addEventListener("DOMContentLoaded",function(e){var t=["name","email","message"].map(function(e){return{key:e,elm:document.querySelector("#"+e)}}).filter(function(e,t){if(null!==e.elm)return!0});Array.prototype.map.call(t,function(e){var t=e.elm;["keyup","blur"].map(function(e){t.addEventListener(e,function(e){null!==t&&t.checkValidity()?(t.parentElement.classList.remove("has-warning"),t.classList.remove("form-control-warning")):(t.parentElement.classList.add("has-warning"),t.classList.add("form-control-warning"))})})});var o=document.querySelector("#msgSubmitBtn");null!==o&&o.addEventListener("click",function(e){0===t.map(function(e){return e.elm.checkValidity()}).filter(function(e){if(!0!==e)return!0}).length&&sendValContactForm(t),e.preventDefault()},!1);var a=document.querySelector("#guestRegistSubmitBtn");null!==a&&a.addEventListener("click",function(e){var t={email:document.querySelector("#email")};t.email.checkValidity()&&sendValGuerstRegist(t),e.preventDefault()},!1);var n=document.querySelector("#email");null!==n&&n.addEventListener("keydown",function(e){if(13==e.keyCode){var t={email:document.querySelector("#email")};null!==t.email&&t.email.checkValidity()&&sendValGuerstRegist(t),e.preventDefault()}},!1)});